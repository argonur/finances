# Sistemas de RecolecciÃ³n y MigraciÃ³n de Datos Financieros

## Sistema Automatizado de RecolecciÃ³n de Ãndices S&P 500 y Nasdaq-100

- Los datos histÃ³ricos previamente almacenados se encuentran en el directorio `/data/HistoricalData_[indice].csv` en total son 2 archivos.
- El propÃ³sito del script es:
  - Determinar el ultimo dÃ­a hÃ¡bil (si hoy es lunes, se buscara datos del viernes anterior).
  - Considerar que la bolsa no opera los fines de semana ni dÃ­as festivos.
  - Obtener datos financieros (APIâ€™ no oficial, yfinance de acceso gratuito).
  - Descargar los precios de cierre de los Ã­ndices especÃ­ficos S&P 500 `(^SPX)` y Nasdaq-100 `(^NDX)`
  - Guardar las nuevas entradas en los archivos CSV.

### Como usar

Dentro del directorio `/scripts/historical_data/` ejecutar el siguiente comando: `python3 historical_index.py`

```bash
# Salida esperada:

==================================================
MENÃš DE ACTUALIZACIÃ“N DE ÃNDICES BURSÃTILES
==================================================
1. Ejecutar en modo automÃ¡tico (recomendado post-cierre)
2. Ejecutar en modo manual (ahora mismo)
3. Ingresar fecha especÃ­fica (formato MM/DD/AAAA)
4. Salir

Seleccione una opciÃ³n:
```

1. _OpciÃ³n 1_ : Busca el ultimo cierre bursÃ¡til de manera automÃ¡tica.
   1. Si la bolsa ya ha cerrado (4 PM, hora local de Nueva York) busca, guarda y respalda en la base de datos el ultimo Ã­ndice.
   2. Si la bolsa aun no ha cerrado, no buscara el ultimo cierre.
2. _OpciÃ³n 2_: Busca el ultimo cierre bursÃ¡til incluso si la bolsa aun no ha cerrado (Recomendado para buscar el ultimo cierre inmediato)
   1. Considere que si la bolsa aun no ha cerrado y fuerza el buscar y almacenar el Ã­ndice del dÃ­a actual, la informaciÃ³n puede no ser 100% fiable
3. _OpciÃ³n 3_: Buscar una fecha en particular y almacenar el cierre.

---

## Sistema de MigraciÃ³n de Datos HistÃ³ricos, Dividendos y Reportes de Ajustes

- El directorio `/scripts/historical_data/datos` es el contenedor de todos los **datos histÃ³ricos, eventos (Dividendos - Split)** de los activos o Ã­ndices.
- Si el directorio no existe, los datos no estÃ¡n actualizados o no existen, ejecutar el siguiente comando dentro de `/scripts`:

```bash
python3 dividendos.py
```

Este comando, creara el directorio `/datos` dentro de \*/scripts, descargara y organizara toda la informaciÃ³n dentro de directorios con el nombre del activo/Ã­ndice de la siguiente manera:

```bash
ğŸ“ /scripts/historical_data/datos/
  â”œâ”€â”€ ğŸ“ Apple/
  â”‚   â”œâ”€â”€ ğŸ“ datos_completos
  â”‚   â”œâ”€â”€ ğŸ“ reportes_ajustes
  â”‚   â””â”€â”€ ğŸ“ reportes_eventos
  â”œâ”€â”€ ğŸ“ Microsoft/
  â””â”€â”€ ğŸ“ S&P 500/
```

---

Ahora que los datos existen y estÃ¡n actualizados procedemos a respaldar la informaciÃ³n en nuestra base de datos en NeÃ³n, ejecuta el siguiente comando:

```bash
/scripts> python3 migration_stock_historical_data.py
# Salida esperada:
âœ… Cargados 40 activos desde JSON

======================================================================
###################### INICIO DE CARGA DE DATOS ######################
======================================================================

ConexiÃ³n exitosa a NeonDB
âœ… Activos cargados exitosamente
âŒ Error cargando eventos: cannot access local variable 'archivo_reciente' where it is not associated with a value
âœ… Datos cargados para S&P500 - 10206 registros
âœ… Datos cargados para NASDAQ-100 - 10018 registros
âœ… Datos cargados para Apple Inc. - 10206 registros
âœ… Datos cargados para Amazon.com Inc. - 7079 registros
âœ… Datos cargados para Adobe Inc. - 9799 registros
âœ… Datos cargados para Alibaba Group Holding Ltd. - 2714 registros
âœ… Datos cargados para Berkshire Hathaway Inc. - 7336 registros
âœ… Datos cargados para Ford Motor Co. - 10206 registros
âœ… Datos cargados para Taiwan Semiconductor Manufacturing Co. - 6977 registros
âœ… Datos cargados para Alibaba Group Holding Ltd. - 2714 registros
âœ… Datos cargados para Apple Inc. - 10206 registros
âœ… Datos cargados para Microsoft Corp. - 9905 registros
âœ… Datos cargados para Alphabet Inc. - 5253 registros
âœ… Datos cargados para Amazon.com Inc. - 7079 registros
âœ… Datos cargados para Tesla Inc. - 3778 registros
âœ… Datos cargados para Meta Platforms Inc. - 3301 registros
âœ… Datos cargados para Netflix Inc. - 5817 registros
âœ… Datos cargados para NVIDIA Corp. - 6654 registros
âœ… Datos cargados para PayPal Holdings Inc. - 2516 registros
âœ… Datos cargados para Salesforce.com Inc. - 5293 registros
âœ… Datos cargados para Adobe Inc. - 9799 registros
âœ… Datos cargados para Intuit Inc. - 8135 registros
âœ… Datos cargados para Oracle Corp. - 9906 registros
âœ… Datos cargados para International Business Machines Corp. - 10206 registros
âœ… Datos cargados para Walmart Inc. - 10206 registros
âœ… Datos cargados para Exxon Mobil Corp. - 10206 registros
âœ… Datos cargados para Chevron Corp. - 10206 registros
âœ… Datos cargados para Berkshire Hathaway Inc. - 7336 registros
âœ… Datos cargados para Visa Inc. - 4352 registros
âœ… Datos cargados para JPMorgan Chase & Co. - 10206 registros
âœ… Datos cargados para UnitedHealth Group Inc. - 10206 registros
âœ… Datos cargados para Procter & Gamble Co. - 10206 registros
âœ… Datos cargados para The Home Depot Inc. - 10206 registros
âœ… Datos cargados para Walt Disney Co. - 10206 registros
âœ… Datos cargados para Verizon Communications Inc. - 10206 registros
âœ… Datos cargados para Intel Corp. - 10206 registros
âœ… Datos cargados para Cisco Systems Inc. - 8910 registros
âœ… Datos cargados para PepsiCo Inc. - 10206 registros
âœ… Datos cargados para Coca-Cola Co. - 10206 registros
âœ… Datos cargados para AT&T Inc. - 10206 registros
âœ… Datos histÃ³ricos cargados exitosamente
ğŸ”Œ ConexiÃ³n cerrada

======================================================================
########################## CARGA COMPLETADA ##########################
======================================================================
```

---
